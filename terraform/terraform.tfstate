{
  "version": 4,
  "terraform_version": "1.14.5",
  "serial": 35,
  "lineage": "b4e8d6e2-7112-939c-62e0-5d19ded80fc3",
  "outputs": {
    "artifacts_bucket": {
      "value": "secure-cicd-artifacts-8e304fae",
      "type": "string"
    },
    "codebuild_projects": {
      "value": {
        "container_build": "secure-cicd-container-build",
        "container_scan": "secure-cicd-container-scan",
        "policy_check": "secure-cicd-policy-check",
        "security_scan": "secure-cicd-security-scan",
        "unit_tests": "secure-cicd-unit-tests"
      },
      "type": [
        "object",
        {
          "container_build": "string",
          "container_scan": "string",
          "policy_check": "string",
          "security_scan": "string",
          "unit_tests": "string"
        }
      ]
    },
    "dynamodb_tables": {
      "value": {
        "audit_logs": "secure-cicd-audit-logs",
        "pipeline_state": "secure-cicd-pipeline-state",
        "scan_results": "secure-cicd-scan-results"
      },
      "type": [
        "object",
        {
          "audit_logs": "string",
          "pipeline_state": "string",
          "scan_results": "string"
        }
      ]
    },
    "ecr_repository_url": {
      "value": "970547342690.dkr.ecr.us-east-1.amazonaws.com/secure-cicd-app",
      "type": "string"
    },
    "pipeline_name": {
      "value": "secure-cicd-pipeline",
      "type": "string"
    },
    "scan_reports_bucket": {
      "value": "secure-cicd-scan-reports-8e304fae",
      "type": "string"
    },
    "sns_topics": {
      "value": {
        "approval_requests": "arn:aws:sns:us-east-1:970547342690:secure-cicd-approval-requests",
        "pipeline_notifications": "arn:aws:sns:us-east-1:970547342690:secure-cicd-pipeline-notifications",
        "security_alerts": "arn:aws:sns:us-east-1:970547342690:secure-cicd-security-alerts"
      },
      "type": [
        "object",
        {
          "approval_requests": "string",
          "pipeline_notifications": "string",
          "security_alerts": "string"
        }
      ]
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "970547342690",
            "arn": "arn:aws:iam::970547342690:user/Winn",
            "id": "970547342690",
            "user_id": "AIDA6D6JBFVRDUPZYTG55"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "aws_region",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "US East (N. Virginia)",
            "endpoint": "ec2.us-east-1.amazonaws.com",
            "id": "us-east-1",
            "name": "us-east-1"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "codebuild",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:970547342690:log-group:/aws/codebuild/secure-cicd",
            "id": "/aws/codebuild/secure-cicd",
            "kms_key_id": "",
            "log_group_class": "STANDARD",
            "name": "/aws/codebuild/secure-cicd",
            "name_prefix": "",
            "retention_in_days": 14,
            "skip_destroy": false,
            "tags": {
              "Name": "secure-cicd-codebuild-logs"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-codebuild-logs",
              "Project": "SecureCICD"
            }
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "codepipeline",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:970547342690:log-group:/aws/codepipeline/secure-cicd",
            "id": "/aws/codepipeline/secure-cicd",
            "kms_key_id": "",
            "log_group_class": "STANDARD",
            "name": "/aws/codepipeline/secure-cicd",
            "name_prefix": "",
            "retention_in_days": 14,
            "skip_destroy": false,
            "tags": {
              "Name": "secure-cicd-codepipeline-logs"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-codepipeline-logs",
              "Project": "SecureCICD"
            }
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_codebuild_project",
      "name": "container_build",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-container-build",
            "artifacts": [
              {
                "artifact_identifier": "",
                "bucket_owner_access": "",
                "encryption_disabled": false,
                "location": "",
                "name": "secure-cicd-container-build",
                "namespace_type": "",
                "override_artifact_name": false,
                "packaging": "NONE",
                "path": "",
                "type": "CODEPIPELINE"
              }
            ],
            "badge_enabled": false,
            "badge_url": "",
            "build_batch_config": [],
            "build_timeout": 30,
            "cache": [
              {
                "location": "",
                "modes": [],
                "type": "NO_CACHE"
              }
            ],
            "concurrent_build_limit": 0,
            "description": "Build and push container image",
            "encryption_key": "arn:aws:kms:us-east-1:970547342690:alias/aws/s3",
            "environment": [
              {
                "certificate": "",
                "compute_type": "BUILD_GENERAL1_SMALL",
                "environment_variable": [
                  {
                    "name": "ECR_REPOSITORY_URI",
                    "type": "PLAINTEXT",
                    "value": "970547342690.dkr.ecr.us-east-1.amazonaws.com/secure-cicd-app"
                  },
                  {
                    "name": "AWS_DEFAULT_REGION",
                    "type": "PLAINTEXT",
                    "value": "us-east-1"
                  },
                  {
                    "name": "AWS_ACCOUNT_ID",
                    "type": "PLAINTEXT",
                    "value": "970547342690"
                  },
                  {
                    "name": "IMAGE_TAG",
                    "type": "PLAINTEXT",
                    "value": "latest"
                  }
                ],
                "fleet": [],
                "image": "aws/codebuild/standard:7.0",
                "image_pull_credentials_type": "CODEBUILD",
                "privileged_mode": true,
                "registry_credential": [],
                "type": "LINUX_CONTAINER"
              }
            ],
            "file_system_locations": [],
            "id": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-container-build",
            "logs_config": [
              {
                "cloudwatch_logs": [
                  {
                    "group_name": "/aws/codebuild/secure-cicd",
                    "status": "ENABLED",
                    "stream_name": "container-build"
                  }
                ],
                "s3_logs": [
                  {
                    "bucket_owner_access": "",
                    "encryption_disabled": false,
                    "location": "",
                    "status": "DISABLED"
                  }
                ]
              }
            ],
            "name": "secure-cicd-container-build",
            "project_visibility": "PRIVATE",
            "public_project_alias": "",
            "queued_timeout": 480,
            "resource_access_role": "",
            "secondary_artifacts": [],
            "secondary_source_version": [],
            "secondary_sources": [],
            "service_role": "arn:aws:iam::970547342690:role/secure-cicd-codebuild-20260219181604414700000001",
            "source": [
              {
                "auth": [],
                "build_status_config": [],
                "buildspec": "version: 0.2\n\nphases:\n  pre_build:\n    commands:\n      - echo \"Logging in to Amazon ECR...\"\n      - aws ecr get-login-password --region $AWS_DEFAULT_REGION | docker login --username AWS --password-stdin $ECR_REPOSITORY_URI\n      - COMMIT_HASH=$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | cut -c 1-7)\n      - IMAGE_TAG=${IMAGE_TAG:-$COMMIT_HASH}\n      - echo \"Building image with tag $IMAGE_TAG\"\n\n  build:\n    commands:\n      - echo \"Building Docker image...\"\n      - cd sample-app\n      - |\n        docker build \\\n          -t $ECR_REPOSITORY_URI:$IMAGE_TAG \\\n          -t $ECR_REPOSITORY_URI:latest \\\n          --build-arg BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ') \\\n          --build-arg VCS_REF=$COMMIT_HASH \\\n          --label \"org.opencontainers.image.created=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" \\\n          --label \"org.opencontainers.image.revision=$COMMIT_HASH\" \\\n          --label \"org.opencontainers.image.version=$IMAGE_TAG\" \\\n          .\n      \n      - echo \"Image built successfully\"\n      - docker images\n\n  post_build:\n    commands:\n      - echo \"Pushing Docker image to ECR...\"\n      - docker push $ECR_REPOSITORY_URI:$IMAGE_TAG\n      - docker push $ECR_REPOSITORY_URI:latest\n      \n      - echo \"Writing image definitions file...\"\n      - |\n        cat \u003e ../imagedefinitions.json \u003c\u003c EOL\n        {\n          \"image_uri\": \"$ECR_REPOSITORY_URI:$IMAGE_TAG\",\n          \"commit_hash\": \"$COMMIT_HASH\",\n          \"build_time\": \"$(date -u +'%Y-%m-%dT%H:%M:%SZ')\"\n        }\n        EOL\n      \n      - echo \"Container build completed\"\n\nartifacts:\n  files:\n    - imagedefinitions.json\n  name: container-build-output\n",
                "git_clone_depth": 0,
                "git_submodules_config": [],
                "insecure_ssl": false,
                "location": "",
                "report_build_status": false,
                "type": "CODEPIPELINE"
              }
            ],
            "source_version": "",
            "tags": {
              "Name": "secure-cicd-container-build"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-container-build",
              "Project": "SecureCICD"
            },
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_log_group.codebuild",
            "aws_ecr_repository.app",
            "aws_iam_role.codebuild_role",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_codebuild_project",
      "name": "container_scan",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-container-scan",
            "artifacts": [
              {
                "artifact_identifier": "",
                "bucket_owner_access": "",
                "encryption_disabled": false,
                "location": "",
                "name": "secure-cicd-container-scan",
                "namespace_type": "",
                "override_artifact_name": false,
                "packaging": "NONE",
                "path": "",
                "type": "CODEPIPELINE"
              }
            ],
            "badge_enabled": false,
            "badge_url": "",
            "build_batch_config": [],
            "build_timeout": 20,
            "cache": [
              {
                "location": "",
                "modes": [],
                "type": "NO_CACHE"
              }
            ],
            "concurrent_build_limit": 0,
            "description": "Scan container image for vulnerabilities",
            "encryption_key": "arn:aws:kms:us-east-1:970547342690:alias/aws/s3",
            "environment": [
              {
                "certificate": "",
                "compute_type": "BUILD_GENERAL1_SMALL",
                "environment_variable": [
                  {
                    "name": "ECR_REPOSITORY_URI",
                    "type": "PLAINTEXT",
                    "value": "970547342690.dkr.ecr.us-east-1.amazonaws.com/secure-cicd-app"
                  },
                  {
                    "name": "IMAGE_TAG",
                    "type": "PLAINTEXT",
                    "value": "latest"
                  },
                  {
                    "name": "SCAN_REPORTS_BUCKET",
                    "type": "PLAINTEXT",
                    "value": "secure-cicd-scan-reports-8e304fae"
                  },
                  {
                    "name": "SCAN_RESULTS_TABLE",
                    "type": "PLAINTEXT",
                    "value": "secure-cicd-scan-results"
                  },
                  {
                    "name": "FAIL_ON_HIGH",
                    "type": "PLAINTEXT",
                    "value": "true"
                  }
                ],
                "fleet": [],
                "image": "aws/codebuild/standard:7.0",
                "image_pull_credentials_type": "CODEBUILD",
                "privileged_mode": true,
                "registry_credential": [],
                "type": "LINUX_CONTAINER"
              }
            ],
            "file_system_locations": [],
            "id": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-container-scan",
            "logs_config": [
              {
                "cloudwatch_logs": [
                  {
                    "group_name": "/aws/codebuild/secure-cicd",
                    "status": "ENABLED",
                    "stream_name": "container-scan"
                  }
                ],
                "s3_logs": [
                  {
                    "bucket_owner_access": "",
                    "encryption_disabled": false,
                    "location": "",
                    "status": "DISABLED"
                  }
                ]
              }
            ],
            "name": "secure-cicd-container-scan",
            "project_visibility": "PRIVATE",
            "public_project_alias": "",
            "queued_timeout": 480,
            "resource_access_role": "",
            "secondary_artifacts": [],
            "secondary_source_version": [],
            "secondary_sources": [],
            "service_role": "arn:aws:iam::970547342690:role/secure-cicd-codebuild-20260219181604414700000001",
            "source": [
              {
                "auth": [],
                "build_status_config": [],
                "buildspec": "version: 0.2\n\nphases:\n  install:\n    commands:\n      - echo \"Installing Trivy...\"\n      - wget -qO - https://aquasecurity.github.io/trivy-repo/deb/public.key | gpg --dearmor -o /usr/share/keyrings/trivy.gpg\n      - echo \"deb [signed-by=/usr/share/keyrings/trivy.gpg] https://aquasecurity.github.io/trivy-repo/deb generic main\" | tee -a /etc/apt/sources.list.d/trivy.list\n      - apt-get update\n      - apt-get install -y trivy\n\n  pre_build:\n    commands:\n      - echo \"Logging in to Amazon ECR...\"\n      - aws ecr get-login-password --region $AWS_DEFAULT_REGION | docker login --username AWS --password-stdin $ECR_REPOSITORY_URI\n      - COMMIT_HASH=$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | cut -c 1-7)\n      - IMAGE_TAG=${IMAGE_TAG:-$COMMIT_HASH}\n      - FULL_IMAGE_URI=\"$ECR_REPOSITORY_URI:$IMAGE_TAG\"\n      - mkdir -p reports\n      - SCAN_ID=\"container-scan-$(date +%s)\"\n\n  build:\n    commands:\n      - echo \"=== Scanning Container Image for Vulnerabilities ===\"\n      - |\n        trivy image \\\n          --severity CRITICAL,HIGH,MEDIUM \\\n          --format json \\\n          --output reports/trivy-vulnerability-scan.json \\\n          $FULL_IMAGE_URI\n      \n      - echo \"=== Scanning for Secrets in Image ===\"\n      - |\n        trivy image \\\n          --scanners secret \\\n          --format json \\\n          --output reports/trivy-secrets-scan.json \\\n          $FULL_IMAGE_URI\n      \n      - echo \"=== Scanning Image Configuration ===\"\n      - |\n        trivy image \\\n          --scanners config \\\n          --format json \\\n          --output reports/trivy-config-scan.json \\\n          $FULL_IMAGE_URI\n      \n      - echo \"=== Analyzing Scan Results ===\"\n      - |\n        CRITICAL_COUNT=$(jq '[.Results[]?.Vulnerabilities[]? | select(.Severity==\"CRITICAL\")] | length' reports/trivy-vulnerability-scan.json || echo \"0\")\n        HIGH_COUNT=$(jq '[.Results[]?.Vulnerabilities[]? | select(.Severity==\"HIGH\")] | length' reports/trivy-vulnerability-scan.json || echo \"0\")\n        MEDIUM_COUNT=$(jq '[.Results[]?.Vulnerabilities[]? | select(.Severity==\"MEDIUM\")] | length' reports/trivy-vulnerability-scan.json || echo \"0\")\n        SECRET_COUNT=$(jq '[.Results[]?.Secrets[]?] | length' reports/trivy-secrets-scan.json || echo \"0\")\n        \n        echo \"Vulnerability Summary:\"\n        echo \"  Critical: $CRITICAL_COUNT\"\n        echo \"  High: $HIGH_COUNT\"\n        echo \"  Medium: $MEDIUM_COUNT\"\n        echo \"  Secrets: $SECRET_COUNT\"\n        \n        # Create summary\n        cat \u003e reports/container-scan-summary.json \u003c\u003c EOL\n        {\n          \"scan_id\": \"$SCAN_ID\",\n          \"image\": \"$FULL_IMAGE_URI\",\n          \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",\n          \"vulnerabilities\": {\n            \"critical\": $CRITICAL_COUNT,\n            \"high\": $HIGH_COUNT,\n            \"medium\": $MEDIUM_COUNT\n          },\n          \"secrets_found\": $SECRET_COUNT\n        }\n        EOL\n\n  post_build:\n    commands:\n      - echo \"=== Uploading Reports to S3 ===\"\n      - aws s3 cp reports/ s3://$SCAN_REPORTS_BUCKET/container-scans/$SCAN_ID/ --recursive\n      \n      - echo \"=== Storing Results in DynamoDB ===\"\n      - |\n        aws dynamodb put-item \\\n          --table-name $SCAN_RESULTS_TABLE \\\n          --item \"{\n            \\\"scan_id\\\": {\\\"S\\\": \\\"$SCAN_ID\\\"},\n            \\\"timestamp\\\": {\\\"S\\\": \\\"$(date -u +%Y-%m-%dT%H:%M:%SZ)\\\"},\n            \\\"scan_type\\\": {\\\"S\\\": \\\"container\\\"},\n            \\\"results\\\": {\\\"S\\\": \\\"$(cat reports/container-scan-summary.json | jq -c .)\\\"},\n            \\\"ttl\\\": {\\\"N\\\": \\\"$(date -d '+90 days' +%s)\\\"}\n          }\"\n      \n      - echo \"=== Checking Scan Results ===\"\n      - |\n        if [ \"$CRITICAL_COUNT\" -gt 0 ] || [ \"$SECRET_COUNT\" -gt 0 ]; then\n          if [ \"$FAIL_ON_HIGH\" = \"true\" ]; then\n            echo \"Container scan FAILED - Critical vulnerabilities or secrets found\"\n            exit 1\n          else\n            echo \"⚠️ Issues found but continuing (FAIL_ON_HIGH=false)\"\n          fi\n        elif [ \"$HIGH_COUNT\" -gt 5 ]; then\n          echo \"⚠️ Warning: High number of HIGH severity vulnerabilities\"\n        else\n          echo \"Container scan PASSED\"\n        fi\n\nartifacts:\n  files:\n    - 'reports/**/*'\n  name: container-scan-reports\n\ncache:\n  paths:\n    - '/root/.cache/trivy/**/*'\n",
                "git_clone_depth": 0,
                "git_submodules_config": [],
                "insecure_ssl": false,
                "location": "",
                "report_build_status": false,
                "type": "CODEPIPELINE"
              }
            ],
            "source_version": "",
            "tags": {
              "Name": "secure-cicd-container-scan"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-container-scan",
              "Project": "SecureCICD"
            },
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_log_group.codebuild",
            "aws_dynamodb_table.scan_results",
            "aws_ecr_repository.app",
            "aws_iam_role.codebuild_role",
            "aws_s3_bucket.scan_reports",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_codebuild_project",
      "name": "policy_check",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-policy-check",
            "artifacts": [
              {
                "artifact_identifier": "",
                "bucket_owner_access": "",
                "encryption_disabled": false,
                "location": "",
                "name": "secure-cicd-policy-check",
                "namespace_type": "",
                "override_artifact_name": false,
                "packaging": "NONE",
                "path": "",
                "type": "CODEPIPELINE"
              }
            ],
            "badge_enabled": false,
            "badge_url": "",
            "build_batch_config": [],
            "build_timeout": 15,
            "cache": [
              {
                "location": "",
                "modes": [],
                "type": "NO_CACHE"
              }
            ],
            "concurrent_build_limit": 0,
            "description": "OPA policy validation",
            "encryption_key": "arn:aws:kms:us-east-1:970547342690:alias/aws/s3",
            "environment": [
              {
                "certificate": "",
                "compute_type": "BUILD_GENERAL1_SMALL",
                "environment_variable": [
                  {
                    "name": "POLICY_ENFORCEMENT_MODE",
                    "type": "PLAINTEXT",
                    "value": "strict"
                  },
                  {
                    "name": "SCAN_REPORTS_BUCKET",
                    "type": "PLAINTEXT",
                    "value": "secure-cicd-scan-reports-8e304fae"
                  },
                  {
                    "name": "AUDIT_LOGS_TABLE",
                    "type": "PLAINTEXT",
                    "value": "secure-cicd-audit-logs"
                  }
                ],
                "fleet": [],
                "image": "aws/codebuild/standard:7.0",
                "image_pull_credentials_type": "CODEBUILD",
                "privileged_mode": false,
                "registry_credential": [],
                "type": "LINUX_CONTAINER"
              }
            ],
            "file_system_locations": [],
            "id": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-policy-check",
            "logs_config": [
              {
                "cloudwatch_logs": [
                  {
                    "group_name": "/aws/codebuild/secure-cicd",
                    "status": "ENABLED",
                    "stream_name": "policy-check"
                  }
                ],
                "s3_logs": [
                  {
                    "bucket_owner_access": "",
                    "encryption_disabled": false,
                    "location": "",
                    "status": "DISABLED"
                  }
                ]
              }
            ],
            "name": "secure-cicd-policy-check",
            "project_visibility": "PRIVATE",
            "public_project_alias": "",
            "queued_timeout": 480,
            "resource_access_role": "",
            "secondary_artifacts": [],
            "secondary_source_version": [],
            "secondary_sources": [],
            "service_role": "arn:aws:iam::970547342690:role/secure-cicd-codebuild-20260219181604414700000001",
            "source": [
              {
                "auth": [],
                "build_status_config": [],
                "buildspec": "version: 0.2\n\nphases:\n  install:\n    commands:\n      - echo \"Installing OPA...\"\n      - curl -L -o /usr/local/bin/opa https://openpolicyagent.org/downloads/v0.59.0/opa_linux_amd64_static\n      - chmod 755 /usr/local/bin/opa\n      - opa version\n\n  pre_build:\n    commands:\n      - echo \"Preparing policy check...\"\n      - mkdir -p reports\n      - POLICY_CHECK_ID=\"policy-$(date +%s)\"\n\n  build:\n    commands:\n      - echo \"=== Running OPA Policy Tests ===\"\n      - |\n        if [ -d \"policies/opa\" ]; then\n          opa test policies/opa -v \u003e reports/opa-test-results.txt 2\u003e\u00261\n          \n          if [ $? -eq 0 ]; then\n            echo \"✓ OPA policy tests passed\"\n            OPA_TEST_RESULT=\"PASS\"\n          else\n            echo \"✗ OPA policy tests failed\"\n            OPA_TEST_RESULT=\"FAIL\"\n            cat reports/opa-test-results.txt\n          fi\n        else\n          echo \"No OPA policies found, skipping\"\n          OPA_TEST_RESULT=\"SKIP\"\n        fi\n      \n      - echo \"=== Evaluating Deployment Policy ===\"\n      - |\n        # Create deployment input for OPA\n        cat \u003e deployment-input.json \u003c\u003c EOL\n        {\n          \"environment\": \"$ENVIRONMENT\",\n          \"deployment_time\": {\n            \"day\": \"$(date +%a)\",\n            \"hour\": $(date +%H)\n          },\n          \"test_results\": {\n            \"passed\": 10,\n            \"failed\": 0\n          },\n          \"security_scan\": {\n            \"critical_count\": 0,\n            \"high_count\": 0,\n            \"medium_count\": 2\n          },\n          \"policy_violations\": [],\n          \"build_status\": \"success\",\n          \"approval\": {\n            \"approved\": false\n          },\n          \"break_glass\": {\n            \"enabled\": false,\n            \"approved\": false\n          }\n        }\n        EOL\n        \n        if [ -f \"policies/opa/deployment.rego\" ]; then\n          opa eval \\\n            --data policies/opa/deployment.rego \\\n            --data policies/opa/data.json \\\n            --input deployment-input.json \\\n            --format pretty \\\n            'data.deployment' \u003e reports/deployment-policy-eval.json\n          \n          ALLOWED=$(jq -r '.allow // false' reports/deployment-policy-eval.json)\n          VIOLATIONS=$(jq -r '.violations // []' reports/deployment-policy-eval.json)\n          \n          echo \"Policy evaluation result: $ALLOWED\"\n          \n          if [ \"$ALLOWED\" != \"true\" ]; then\n            echo \"Policy violations detected:\"\n            echo \"$VIOLATIONS\" | jq -r '.[]'\n            POLICY_RESULT=\"FAIL\"\n          else\n            echo \"✓ Deployment policy check passed\"\n            POLICY_RESULT=\"PASS\"\n          fi\n        else\n          echo \"No deployment policy found\"\n          POLICY_RESULT=\"SKIP\"\n        fi\n\n  post_build:\n    commands:\n      - echo \"=== Generating Policy Report ===\"\n      - |\n        cat \u003e reports/policy-check-summary.json \u003c\u003c EOL\n        {\n          \"check_id\": \"$POLICY_CHECK_ID\",\n          \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",\n          \"enforcement_mode\": \"$POLICY_ENFORCEMENT_MODE\",\n          \"results\": {\n            \"opa_tests\": \"$OPA_TEST_RESULT\",\n            \"deployment_policy\": \"$POLICY_RESULT\"\n          }\n        }\n        EOL\n      \n      - echo \"=== Uploading Reports ===\"\n      - aws s3 cp reports/ s3://$SCAN_REPORTS_BUCKET/policy-checks/$POLICY_CHECK_ID/ --recursive\n      \n      - echo \"=== Logging to Audit Table ===\"\n      - |\n        aws dynamodb put-item \\\n          --table-name $AUDIT_LOGS_TABLE \\\n          --item \"{\n            \\\"event_id\\\": {\\\"S\\\": \\\"$POLICY_CHECK_ID\\\"},\n            \\\"timestamp\\\": {\\\"S\\\": \\\"$(date -u +%Y-%m-%dT%H:%M:%SZ)\\\"},\n            \\\"event_type\\\": {\\\"S\\\": \\\"policy_check\\\"},\n            \\\"details\\\": {\\\"S\\\": \\\"$(cat reports/policy-check-summary.json | jq -c .)\\\"},\n            \\\"ttl\\\": {\\\"N\\\": \\\"$(date -d '+365 days' +%s)\\\"}\n          }\"\n      \n      - echo \"=== Evaluating Results ===\"\n      - |\n        if [ \"$POLICY_RESULT\" = \"FAIL\" ]; then\n          if [ \"$POLICY_ENFORCEMENT_MODE\" = \"strict\" ]; then\n            echo \"Policy check FAILED in strict mode - blocking deployment\"\n            exit 1\n          elif [ \"$POLICY_ENFORCEMENT_MODE\" = \"advisory\" ]; then\n            echo \"⚠️ Policy violations found but continuing (advisory mode)\"\n          fi\n        else\n          echo \"Policy check PASSED\"\n        fi\n\nartifacts:\n  files:\n    - 'reports/**/*'\n  name: policy-check-reports\n",
                "git_clone_depth": 0,
                "git_submodules_config": [],
                "insecure_ssl": false,
                "location": "",
                "report_build_status": false,
                "type": "CODEPIPELINE"
              }
            ],
            "source_version": "",
            "tags": {
              "Name": "secure-cicd-policy-check"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-policy-check",
              "Project": "SecureCICD"
            },
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_log_group.codebuild",
            "aws_dynamodb_table.audit_logs",
            "aws_iam_role.codebuild_role",
            "aws_s3_bucket.scan_reports",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_codebuild_project",
      "name": "security_scan",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-security-scan",
            "artifacts": [
              {
                "artifact_identifier": "",
                "bucket_owner_access": "",
                "encryption_disabled": false,
                "location": "",
                "name": "secure-cicd-security-scan",
                "namespace_type": "",
                "override_artifact_name": false,
                "packaging": "NONE",
                "path": "",
                "type": "CODEPIPELINE"
              }
            ],
            "badge_enabled": false,
            "badge_url": "",
            "build_batch_config": [],
            "build_timeout": 30,
            "cache": [
              {
                "location": "",
                "modes": [],
                "type": "NO_CACHE"
              }
            ],
            "concurrent_build_limit": 0,
            "description": "Security scanning stage",
            "encryption_key": "arn:aws:kms:us-east-1:970547342690:alias/aws/s3",
            "environment": [
              {
                "certificate": "",
                "compute_type": "BUILD_GENERAL1_SMALL",
                "environment_variable": [
                  {
                    "name": "SCAN_REPORTS_BUCKET",
                    "type": "PLAINTEXT",
                    "value": "secure-cicd-scan-reports-8e304fae"
                  },
                  {
                    "name": "SECURITY_ALERTS_TOPIC",
                    "type": "PLAINTEXT",
                    "value": "arn:aws:sns:us-east-1:970547342690:secure-cicd-security-alerts"
                  },
                  {
                    "name": "SCAN_RESULTS_TABLE",
                    "type": "PLAINTEXT",
                    "value": "secure-cicd-scan-results"
                  },
                  {
                    "name": "FAIL_ON_HIGH",
                    "type": "PLAINTEXT",
                    "value": "true"
                  }
                ],
                "fleet": [],
                "image": "aws/codebuild/standard:7.0",
                "image_pull_credentials_type": "CODEBUILD",
                "privileged_mode": true,
                "registry_credential": [],
                "type": "LINUX_CONTAINER"
              }
            ],
            "file_system_locations": [],
            "id": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-security-scan",
            "logs_config": [
              {
                "cloudwatch_logs": [
                  {
                    "group_name": "/aws/codebuild/secure-cicd",
                    "status": "ENABLED",
                    "stream_name": "security-scan"
                  }
                ],
                "s3_logs": [
                  {
                    "bucket_owner_access": "",
                    "encryption_disabled": false,
                    "location": "",
                    "status": "DISABLED"
                  }
                ]
              }
            ],
            "name": "secure-cicd-security-scan",
            "project_visibility": "PRIVATE",
            "public_project_alias": "",
            "queued_timeout": 480,
            "resource_access_role": "",
            "secondary_artifacts": [],
            "secondary_source_version": [],
            "secondary_sources": [],
            "service_role": "arn:aws:iam::970547342690:role/secure-cicd-codebuild-20260219181604414700000001",
            "source": [
              {
                "auth": [],
                "build_status_config": [],
                "buildspec": "version: 0.2\n\nphases:\n  install:\n    runtime-versions:\n      python: 3.11\n    commands:\n      - echo \"Installing security scanning tools...\"\n      # Install Trivy\n      - wget -qO - https://aquasecurity.github.io/trivy-repo/deb/public.key | gpg --dearmor -o /usr/share/keyrings/trivy.gpg\n      - echo \"deb [signed-by=/usr/share/keyrings/trivy.gpg] https://aquasecurity.github.io/trivy-repo/deb generic main\" | tee -a /etc/apt/sources.list.d/trivy.list\n      - apt-get update\n      - apt-get install -y trivy\n      \n      # Install Checkov\n      - pip3 install checkov\n      \n      # Install git-secrets\n      - git clone https://github.com/awslabs/git-secrets.git /tmp/git-secrets\n      - cd /tmp/git-secrets \u0026\u0026 make install\n      \n      # Install OPA\n      - curl -L -o /usr/local/bin/opa https://openpolicyagent.org/downloads/v0.59.0/opa_linux_amd64_static\n      - chmod 755 /usr/local/bin/opa\n\n  pre_build:\n    commands:\n      - echo \"Starting security scans...\"\n      - mkdir -p reports\n      - SCAN_ID=\"scan-$(date +%s)\"\n      - TIMESTAMP=$(date -u +%Y-%m-%dT%H:%M:%SZ)\n\n  build:\n    commands:\n      - echo \"=== Secrets Scanning ===\"\n      - |\n        # Initialize git-secrets\n        git secrets --install || true\n        git secrets --register-aws || true\n        \n        # Scan for secrets\n        if git secrets --scan -r .; then\n          echo \"✓ No secrets found\"\n          SECRETS_RESULT=\"PASS\"\n        else\n          echo \"✗ Secrets detected!\"\n          SECRETS_RESULT=\"FAIL\"\n          echo '{\"severity\":\"CRITICAL\",\"message\":\"Secrets detected in code\"}' \u003e reports/secrets-findings.json\n        fi\n      \n      - echo \"=== Infrastructure Scanning ===\"\n      - |\n        # Scan Terraform files with Checkov\n        if [ -d \"terraform\" ]; then\n          checkov \\\n            --directory terraform \\\n            --framework terraform \\\n            --output json \\\n            --output-file-path reports/ \\\n            --soft-fail || true\n          \n          if [ -f \"reports/results_json.json\" ]; then\n            mv reports/results_json.json reports/checkov-results.json\n            \n            FAILED=$(jq '.summary.failed' reports/checkov-results.json)\n            if [ \"$FAILED\" -gt 0 ]; then\n              echo \"✗ Found $FAILED Checkov violations\"\n              IAC_RESULT=\"FAIL\"\n            else\n              echo \"✓ Checkov scan passed\"\n              IAC_RESULT=\"PASS\"\n            fi\n          fi\n        else\n          echo \"No Terraform files to scan\"\n          IAC_RESULT=\"SKIP\"\n        fi\n      \n      - echo \"=== Dockerfile Scanning ===\"\n      - |\n        # Scan Dockerfile with Trivy\n        if [ -f \"sample-app/Dockerfile\" ]; then\n          trivy config \\\n            --severity HIGH,CRITICAL \\\n            --format json \\\n            --output reports/dockerfile-scan.json \\\n            sample-app/Dockerfile || true\n          \n          DOCKERFILE_ISSUES=$(jq '[.Results[]?.Misconfigurations[]? | select(.Severity==\"HIGH\" or .Severity==\"CRITICAL\")] | length' reports/dockerfile-scan.json || echo \"0\")\n          \n          if [ \"$DOCKERFILE_ISSUES\" -gt 0 ]; then\n            echo \"✗ Found $DOCKERFILE_ISSUES Dockerfile issues\"\n            DOCKERFILE_RESULT=\"FAIL\"\n          else\n            echo \"✓ Dockerfile scan passed\"\n            DOCKERFILE_RESULT=\"PASS\"\n          fi\n        else\n          echo \"No Dockerfile to scan\"\n          DOCKERFILE_RESULT=\"SKIP\"\n        fi\n\n  post_build:\n    commands:\n      - echo \"=== Generating Security Report ===\"\n      - |\n        # Create summary report\n        cat \u003e reports/security-scan-summary.json \u003c\u003c EOL\n        {\n          \"scan_id\": \"$SCAN_ID\",\n          \"timestamp\": \"$TIMESTAMP\",\n          \"results\": {\n            \"secrets_scan\": \"$SECRETS_RESULT\",\n            \"iac_scan\": \"$IAC_RESULT\",\n            \"dockerfile_scan\": \"$DOCKERFILE_RESULT\"\n          },\n          \"environment\": \"$ENVIRONMENT\"\n        }\n        EOL\n      \n      - echo \"=== Uploading Reports to S3 ===\"\n      - aws s3 cp reports/ s3://$SCAN_REPORTS_BUCKET/security-scans/$SCAN_ID/ --recursive\n      \n      - echo \"=== Storing Results in DynamoDB ===\"\n      - |\n        aws dynamodb put-item \\\n          --table-name $SCAN_RESULTS_TABLE \\\n          --item \"{\n            \\\"scan_id\\\": {\\\"S\\\": \\\"$SCAN_ID\\\"},\n            \\\"timestamp\\\": {\\\"S\\\": \\\"$TIMESTAMP\\\"},\n            \\\"scan_type\\\": {\\\"S\\\": \\\"security\\\"},\n            \\\"results\\\": {\\\"S\\\": \\\"$(cat reports/security-scan-summary.json | jq -c .)\\\"},\n            \\\"ttl\\\": {\\\"N\\\": \\\"$(date -d '+90 days' +%s)\\\"}\n          }\"\n      \n      - echo \"=== Checking for Failures ===\"\n      - |\n        if [ \"$SECRETS_RESULT\" = \"FAIL\" ] || [ \"$IAC_RESULT\" = \"FAIL\" ]; then\n          if [ \"$FAIL_ON_HIGH\" = \"true\" ]; then\n            echo \"Security scan FAILED - blocking pipeline\"\n            \n            # Send alert\n            aws sns publish \\\n              --topic-arn $SECURITY_ALERTS_TOPIC \\\n              --subject \"Security Scan Failed\" \\\n              --message \"Security scan detected critical issues. Check S3 bucket: $SCAN_REPORTS_BUCKET/security-scans/$SCAN_ID/\"\n            \n            exit 1\n          else\n            echo \"Security issues found but continuing (FAIL_ON_HIGH=false)\"\n          fi\n        else\n          echo \"Security scan PASSED\"\n        fi\n\nartifacts:\n  files:\n    - 'reports/**/*'\n  name: security-scan-reports\n\ncache:\n  paths:\n    - '/root/.cache/trivy/**/*'\n",
                "git_clone_depth": 0,
                "git_submodules_config": [],
                "insecure_ssl": false,
                "location": "",
                "report_build_status": false,
                "type": "CODEPIPELINE"
              }
            ],
            "source_version": "",
            "tags": {
              "Name": "secure-cicd-security-scan"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-security-scan",
              "Project": "SecureCICD"
            },
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_log_group.codebuild",
            "aws_dynamodb_table.scan_results",
            "aws_iam_role.codebuild_role",
            "aws_kms_key.secrets",
            "aws_s3_bucket.scan_reports",
            "aws_sns_topic.security_alerts",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_codebuild_project",
      "name": "unit_tests",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-unit-tests",
            "artifacts": [
              {
                "artifact_identifier": "",
                "bucket_owner_access": "",
                "encryption_disabled": false,
                "location": "",
                "name": "secure-cicd-unit-tests",
                "namespace_type": "",
                "override_artifact_name": false,
                "packaging": "NONE",
                "path": "",
                "type": "CODEPIPELINE"
              }
            ],
            "badge_enabled": false,
            "badge_url": "",
            "build_batch_config": [],
            "build_timeout": 15,
            "cache": [
              {
                "location": "",
                "modes": [],
                "type": "NO_CACHE"
              }
            ],
            "concurrent_build_limit": 0,
            "description": "Run unit tests",
            "encryption_key": "arn:aws:kms:us-east-1:970547342690:alias/aws/s3",
            "environment": [
              {
                "certificate": "",
                "compute_type": "BUILD_GENERAL1_SMALL",
                "environment_variable": [
                  {
                    "name": "ENVIRONMENT",
                    "type": "PLAINTEXT",
                    "value": "dev"
                  }
                ],
                "fleet": [],
                "image": "aws/codebuild/standard:7.0",
                "image_pull_credentials_type": "CODEBUILD",
                "privileged_mode": false,
                "registry_credential": [],
                "type": "LINUX_CONTAINER"
              }
            ],
            "file_system_locations": [],
            "id": "arn:aws:codebuild:us-east-1:970547342690:project/secure-cicd-unit-tests",
            "logs_config": [
              {
                "cloudwatch_logs": [
                  {
                    "group_name": "/aws/codebuild/secure-cicd",
                    "status": "ENABLED",
                    "stream_name": "unit-tests"
                  }
                ],
                "s3_logs": [
                  {
                    "bucket_owner_access": "",
                    "encryption_disabled": false,
                    "location": "",
                    "status": "DISABLED"
                  }
                ]
              }
            ],
            "name": "secure-cicd-unit-tests",
            "project_visibility": "PRIVATE",
            "public_project_alias": "",
            "queued_timeout": 480,
            "resource_access_role": "",
            "secondary_artifacts": [],
            "secondary_source_version": [],
            "secondary_sources": [],
            "service_role": "arn:aws:iam::970547342690:role/secure-cicd-codebuild-20260219181604414700000001",
            "source": [
              {
                "auth": [],
                "build_status_config": [],
                "buildspec": "version: 0.2\n\nphases:\n  install:\n    runtime-versions:\n      python: 3.11\n    commands:\n      - echo \"Installing dependencies...\"\n      - cd sample-app\n      - pip3 install -r requirements.txt\n      - pip3 install pytest pytest-cov\n\n  build:\n    commands:\n      - echo \"Running unit tests...\"\n      - |\n        pytest tests/ \\\n          --verbose \\\n          --junitxml=../reports/junit.xml \\\n          --cov=src \\\n          --cov-report=xml:../reports/coverage.xml \\\n          --cov-report=html:../reports/coverage-html \\\n          --cov-report=term\n      \n      - echo \"Tests completed\"\n\n  post_build:\n    commands:\n      - echo \"Analyzing test results...\"\n      - |\n        if [ -f \"../reports/junit.xml\" ]; then\n          TESTS_TOTAL=$(xmllint --xpath 'count(//testsuite/@tests)' ../reports/junit.xml)\n          TESTS_FAILURES=$(xmllint --xpath 'count(//testsuite/@failures)' ../reports/junit.xml)\n          TESTS_ERRORS=$(xmllint --xpath 'count(//testsuite/@errors)' ../reports/junit.xml)\n          \n          echo \"Test Summary:\"\n          echo \"  Total: $TESTS_TOTAL\"\n          echo \"  Failures: $TESTS_FAILURES\"\n          echo \"  Errors: $TESTS_ERRORS\"\n          \n          if [ \"$TESTS_FAILURES\" -gt 0 ] || [ \"$TESTS_ERRORS\" -gt 0 ]; then\n            echo \"Tests FAILED\"\n            exit 1\n          else\n            echo \"All tests PASSED\"\n          fi\n        else\n          echo \"No test results found\"\n          exit 1\n        fi\n\nartifacts:\n  files:\n    - 'reports/**/*'\n  name: test-reports\n\nreports:\n  pytest_reports:\n    files:\n      - 'reports/junit.xml'\n    file-format: 'JUNITXML'\n",
                "git_clone_depth": 0,
                "git_submodules_config": [],
                "insecure_ssl": false,
                "location": "",
                "report_build_status": false,
                "type": "CODEPIPELINE"
              }
            ],
            "source_version": "",
            "tags": {
              "Name": "secure-cicd-unit-tests"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-unit-tests",
              "Project": "SecureCICD"
            },
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_log_group.codebuild",
            "aws_iam_role.codebuild_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_dynamodb_table",
      "name": "audit_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:dynamodb:us-east-1:970547342690:table/secure-cicd-audit-logs",
            "attribute": [
              {
                "name": "event_id",
                "type": "S"
              },
              {
                "name": "event_type",
                "type": "S"
              },
              {
                "name": "timestamp",
                "type": "S"
              }
            ],
            "billing_mode": "PAY_PER_REQUEST",
            "deletion_protection_enabled": false,
            "global_secondary_index": [
              {
                "hash_key": "event_type",
                "name": "EventTypeIndex",
                "non_key_attributes": [],
                "on_demand_throughput": [],
                "projection_type": "ALL",
                "range_key": "timestamp",
                "read_capacity": 0,
                "write_capacity": 0
              }
            ],
            "hash_key": "event_id",
            "id": "secure-cicd-audit-logs",
            "import_table": [],
            "local_secondary_index": [],
            "name": "secure-cicd-audit-logs",
            "on_demand_throughput": [],
            "point_in_time_recovery": [
              {
                "enabled": false,
                "recovery_period_in_days": 0
              }
            ],
            "range_key": "timestamp",
            "read_capacity": 0,
            "replica": [],
            "restore_date_time": null,
            "restore_source_name": null,
            "restore_source_table_arn": null,
            "restore_to_latest_time": null,
            "server_side_encryption": [],
            "stream_arn": "",
            "stream_enabled": false,
            "stream_label": "",
            "stream_view_type": "",
            "table_class": "STANDARD",
            "tags": {
              "Name": "secure-cicd-audit-logs"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-audit-logs",
              "Project": "SecureCICD"
            },
            "timeouts": null,
            "ttl": [
              {
                "attribute_name": "ttl",
                "enabled": true
              }
            ],
            "write_capacity": 0
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_dynamodb_table",
      "name": "pipeline_state",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:dynamodb:us-east-1:970547342690:table/secure-cicd-pipeline-state",
            "attribute": [
              {
                "name": "execution_id",
                "type": "S"
              },
              {
                "name": "pipeline_id",
                "type": "S"
              },
              {
                "name": "status",
                "type": "S"
              }
            ],
            "billing_mode": "PAY_PER_REQUEST",
            "deletion_protection_enabled": false,
            "global_secondary_index": [
              {
                "hash_key": "status",
                "name": "StatusIndex",
                "non_key_attributes": [],
                "on_demand_throughput": [],
                "projection_type": "ALL",
                "range_key": "execution_id",
                "read_capacity": 0,
                "write_capacity": 0
              }
            ],
            "hash_key": "pipeline_id",
            "id": "secure-cicd-pipeline-state",
            "import_table": [],
            "local_secondary_index": [],
            "name": "secure-cicd-pipeline-state",
            "on_demand_throughput": [],
            "point_in_time_recovery": [
              {
                "enabled": true,
                "recovery_period_in_days": 35
              }
            ],
            "range_key": "execution_id",
            "read_capacity": 0,
            "replica": [],
            "restore_date_time": null,
            "restore_source_name": null,
            "restore_source_table_arn": null,
            "restore_to_latest_time": null,
            "server_side_encryption": [],
            "stream_arn": "",
            "stream_enabled": false,
            "stream_label": "",
            "stream_view_type": "",
            "table_class": "STANDARD",
            "tags": {
              "Name": "secure-cicd-pipeline-state"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-pipeline-state",
              "Project": "SecureCICD"
            },
            "timeouts": null,
            "ttl": [
              {
                "attribute_name": "ttl",
                "enabled": true
              }
            ],
            "write_capacity": 0
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_dynamodb_table",
      "name": "scan_results",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:dynamodb:us-east-1:970547342690:table/secure-cicd-scan-results",
            "attribute": [
              {
                "name": "scan_id",
                "type": "S"
              },
              {
                "name": "scan_type",
                "type": "S"
              },
              {
                "name": "timestamp",
                "type": "S"
              }
            ],
            "billing_mode": "PAY_PER_REQUEST",
            "deletion_protection_enabled": false,
            "global_secondary_index": [
              {
                "hash_key": "scan_type",
                "name": "ScanTypeIndex",
                "non_key_attributes": [],
                "on_demand_throughput": [],
                "projection_type": "ALL",
                "range_key": "timestamp",
                "read_capacity": 0,
                "write_capacity": 0
              }
            ],
            "hash_key": "scan_id",
            "id": "secure-cicd-scan-results",
            "import_table": [],
            "local_secondary_index": [],
            "name": "secure-cicd-scan-results",
            "on_demand_throughput": [],
            "point_in_time_recovery": [
              {
                "enabled": false,
                "recovery_period_in_days": 0
              }
            ],
            "range_key": "timestamp",
            "read_capacity": 0,
            "replica": [],
            "restore_date_time": null,
            "restore_source_name": null,
            "restore_source_table_arn": null,
            "restore_to_latest_time": null,
            "server_side_encryption": [],
            "stream_arn": "",
            "stream_enabled": false,
            "stream_label": "",
            "stream_view_type": "",
            "table_class": "STANDARD",
            "tags": {
              "Name": "secure-cicd-scan-results"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-scan-results",
              "Project": "SecureCICD"
            },
            "timeouts": null,
            "ttl": [
              {
                "attribute_name": "ttl",
                "enabled": true
              }
            ],
            "write_capacity": 0
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ecr_lifecycle_policy",
      "name": "app",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "secure-cicd-app",
            "policy": "{\"rules\":[{\"action\":{\"type\":\"expire\"},\"description\":\"Keep last 10 images\",\"rulePriority\":1,\"selection\":{\"countNumber\":10,\"countType\":\"imageCountMoreThan\",\"tagStatus\":\"any\"}}]}",
            "registry_id": "970547342690",
            "repository": "secure-cicd-app"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_ecr_repository.app"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ecr_repository",
      "name": "app",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ecr:us-east-1:970547342690:repository/secure-cicd-app",
            "encryption_configuration": [
              {
                "encryption_type": "AES256",
                "kms_key": ""
              }
            ],
            "force_delete": null,
            "id": "secure-cicd-app",
            "image_scanning_configuration": [
              {
                "scan_on_push": true
              }
            ],
            "image_tag_mutability": "IMMUTABLE",
            "name": "secure-cicd-app",
            "registry_id": "970547342690",
            "repository_url": "970547342690.dkr.ecr.us-east-1.amazonaws.com/secure-cicd-app",
            "tags": {
              "Name": "secure-cicd-app-repo"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-app-repo",
              "Project": "SecureCICD"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjoxMjAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "codebuild_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::970547342690:role/secure-cicd-codebuild-20260219181604414700000001",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"codebuild.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2026-02-19T18:16:04Z",
            "description": "",
            "force_detach_policies": false,
            "id": "secure-cicd-codebuild-20260219181604414700000001",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "secure-cicd-codebuild-20260219181604414700000001",
            "name_prefix": "secure-cicd-codebuild-",
            "path": "/",
            "permissions_boundary": "",
            "tags": {
              "Name": "secure-cicd-codebuild-role"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-codebuild-role",
              "Project": "SecureCICD"
            },
            "unique_id": "AROA6D6JBFVRH5NAROFHX"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "codepipeline_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::970547342690:role/secure-cicd-codepipeline-20260219181604450500000002",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"codepipeline.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2026-02-19T18:16:04Z",
            "description": "",
            "force_detach_policies": false,
            "id": "secure-cicd-codepipeline-20260219181604450500000002",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "secure-cicd-codepipeline-20260219181604450500000002",
            "name_prefix": "secure-cicd-codepipeline-",
            "path": "/",
            "permissions_boundary": "",
            "tags": {
              "Name": "secure-cicd-codepipeline-role"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-codepipeline-role",
              "Project": "SecureCICD"
            },
            "unique_id": "AROA6D6JBFVRNFVYODM6H"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "codepipeline_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "secure-cicd-codepipeline-20260219181604450500000002:secure-cicd-codepipeline-20260219181627459600000005",
            "name": "secure-cicd-codepipeline-20260219181627459600000005",
            "name_prefix": "secure-cicd-codepipeline-",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"s3:GetObject\",\"s3:PutObject\",\"s3:GetBucketLocation\",\"s3:ListBucket\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3:::secure-cicd-artifacts-8e304fae\",\"arn:aws:s3:::secure-cicd-artifacts-8e304fae/*\"]},{\"Action\":[\"codebuild:BatchGetBuilds\",\"codebuild:StartBuild\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"sns:Publish\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:sns:us-east-1:970547342690:secure-cicd-pipeline-notifications\",\"arn:aws:sns:us-east-1:970547342690:secure-cicd-approval-requests\"]},{\"Action\":[\"dynamodb:PutItem\",\"dynamodb:GetItem\",\"dynamodb:UpdateItem\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:dynamodb:us-east-1:970547342690:table/secure-cicd-pipeline-state\",\"arn:aws:dynamodb:us-east-1:970547342690:table/secure-cicd-audit-logs\"]}]}",
            "role": "secure-cicd-codepipeline-20260219181604450500000002"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_dynamodb_table.audit_logs",
            "aws_dynamodb_table.pipeline_state",
            "aws_iam_role.codepipeline_role",
            "aws_kms_key.secrets",
            "aws_s3_bucket.pipeline_artifacts",
            "aws_sns_topic.approval_requests",
            "aws_sns_topic.pipeline_notifications",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_alias",
      "name": "secrets",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:970547342690:alias/secure-cicd-secrets",
            "id": "alias/secure-cicd-secrets",
            "name": "alias/secure-cicd-secrets",
            "name_prefix": "",
            "target_key_arn": "arn:aws:kms:us-east-1:970547342690:key/3579e2eb-ff74-42d3-8122-18fc70a85b16",
            "target_key_id": "3579e2eb-ff74-42d3-8122-18fc70a85b16"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.secrets"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_key",
      "name": "secrets",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:970547342690:key/3579e2eb-ff74-42d3-8122-18fc70a85b16",
            "bypass_policy_lockout_safety_check": false,
            "custom_key_store_id": "",
            "customer_master_key_spec": "SYMMETRIC_DEFAULT",
            "deletion_window_in_days": 10,
            "description": "KMS key for secure-cicd secrets",
            "enable_key_rotation": true,
            "id": "3579e2eb-ff74-42d3-8122-18fc70a85b16",
            "is_enabled": true,
            "key_id": "3579e2eb-ff74-42d3-8122-18fc70a85b16",
            "key_usage": "ENCRYPT_DECRYPT",
            "multi_region": false,
            "policy": "{\"Id\":\"key-default-1\",\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::970547342690:root\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"}],\"Version\":\"2012-10-17\"}",
            "rotation_period_in_days": 365,
            "tags": {
              "Name": "secure-cicd-secrets-key"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-secrets-key",
              "Project": "SecureCICD"
            },
            "timeouts": null,
            "xks_key_id": ""
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDB9fQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "pipeline_artifacts",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::secure-cicd-artifacts-8e304fae",
            "bucket": "secure-cicd-artifacts-8e304fae",
            "bucket_domain_name": "secure-cicd-artifacts-8e304fae.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "secure-cicd-artifacts-8e304fae.s3.us-east-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [
              {
                "id": "c33b09d322b54869eba1bbf78dbeca9dfbff00a3c050c6cbe2f2b4483a8fbeef",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z3AQBSTGFYJSTF",
            "id": "secure-cicd-artifacts-8e304fae",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-east-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {
              "Name": "secure-cicd-artifacts"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-artifacts",
              "Project": "SecureCICD"
            },
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "scan_reports",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::secure-cicd-scan-reports-8e304fae",
            "bucket": "secure-cicd-scan-reports-8e304fae",
            "bucket_domain_name": "secure-cicd-scan-reports-8e304fae.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "secure-cicd-scan-reports-8e304fae.s3.us-east-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [
              {
                "id": "c33b09d322b54869eba1bbf78dbeca9dfbff00a3c050c6cbe2f2b4483a8fbeef",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z3AQBSTGFYJSTF",
            "id": "secure-cicd-scan-reports-8e304fae",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-east-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {
              "Name": "secure-cicd-scan-reports"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-scan-reports",
              "Project": "SecureCICD"
            },
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_lifecycle_configuration",
      "name": "scan_reports",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "bucket": "secure-cicd-scan-reports-8e304fae",
            "expected_bucket_owner": "",
            "id": "secure-cicd-scan-reports-8e304fae",
            "rule": [
              {
                "abort_incomplete_multipart_upload": [],
                "expiration": [
                  {
                    "date": null,
                    "days": 90,
                    "expired_object_delete_marker": false
                  }
                ],
                "filter": [
                  {
                    "and": [],
                    "object_size_greater_than": null,
                    "object_size_less_than": null,
                    "prefix": "",
                    "tag": []
                  }
                ],
                "id": "delete-old-reports",
                "noncurrent_version_expiration": [],
                "noncurrent_version_transition": [],
                "prefix": "",
                "status": "Enabled",
                "transition": []
              }
            ],
            "timeouts": null,
            "transition_default_minimum_object_size": "all_storage_classes_128K"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_s3_bucket.scan_reports",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_public_access_block",
      "name": "pipeline_artifacts",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "block_public_acls": true,
            "block_public_policy": true,
            "bucket": "secure-cicd-artifacts-8e304fae",
            "id": "secure-cicd-artifacts-8e304fae",
            "ignore_public_acls": true,
            "restrict_public_buckets": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.pipeline_artifacts",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_server_side_encryption_configuration",
      "name": "pipeline_artifacts",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "secure-cicd-artifacts-8e304fae",
            "expected_bucket_owner": "",
            "id": "secure-cicd-artifacts-8e304fae",
            "rule": [
              {
                "apply_server_side_encryption_by_default": [
                  {
                    "kms_master_key_id": "",
                    "sse_algorithm": "AES256"
                  }
                ],
                "bucket_key_enabled": null
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.pipeline_artifacts",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_server_side_encryption_configuration",
      "name": "scan_reports",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "secure-cicd-scan-reports-8e304fae",
            "expected_bucket_owner": "",
            "id": "secure-cicd-scan-reports-8e304fae",
            "rule": [
              {
                "apply_server_side_encryption_by_default": [
                  {
                    "kms_master_key_id": "",
                    "sse_algorithm": "AES256"
                  }
                ],
                "bucket_key_enabled": null
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.scan_reports",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_versioning",
      "name": "pipeline_artifacts",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "secure-cicd-artifacts-8e304fae",
            "expected_bucket_owner": "",
            "id": "secure-cicd-artifacts-8e304fae",
            "mfa": null,
            "versioning_configuration": [
              {
                "mfa_delete": "",
                "status": "Enabled"
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.pipeline_artifacts",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_versioning",
      "name": "scan_reports",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "secure-cicd-scan-reports-8e304fae",
            "expected_bucket_owner": "",
            "id": "secure-cicd-scan-reports-8e304fae",
            "mfa": null,
            "versioning_configuration": [
              {
                "mfa_delete": "",
                "status": "Enabled"
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.scan_reports",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_secretsmanager_secret",
      "name": "ecr_credentials",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:secretsmanager:us-east-1:970547342690:secret:secure-cicd-ecr-credentials-xS1u92",
            "description": "ECR credentials for container scanning",
            "force_overwrite_replica_secret": false,
            "id": "arn:aws:secretsmanager:us-east-1:970547342690:secret:secure-cicd-ecr-credentials-xS1u92",
            "kms_key_id": "3579e2eb-ff74-42d3-8122-18fc70a85b16",
            "name": "secure-cicd-ecr-credentials",
            "name_prefix": "",
            "policy": "",
            "recovery_window_in_days": 7,
            "replica": [],
            "tags": {
              "Name": "secure-cicd-ecr-credentials"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-ecr-credentials",
              "Project": "SecureCICD"
            }
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.secrets"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "approval_requests",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": 0,
            "archive_policy": "",
            "arn": "arn:aws:sns:us-east-1:970547342690:secure-cicd-approval-requests",
            "beginning_archive_time": "",
            "content_based_deduplication": false,
            "delivery_policy": "",
            "display_name": "",
            "fifo_throughput_scope": "",
            "fifo_topic": false,
            "firehose_failure_feedback_role_arn": "",
            "firehose_success_feedback_role_arn": "",
            "firehose_success_feedback_sample_rate": 0,
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": 0,
            "id": "arn:aws:sns:us-east-1:970547342690:secure-cicd-approval-requests",
            "kms_master_key_id": "3579e2eb-ff74-42d3-8122-18fc70a85b16",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": 0,
            "name": "secure-cicd-approval-requests",
            "name_prefix": "",
            "owner": "970547342690",
            "policy": "{\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Action\":[\"SNS:GetTopicAttributes\",\"SNS:SetTopicAttributes\",\"SNS:AddPermission\",\"SNS:RemovePermission\",\"SNS:DeleteTopic\",\"SNS:Subscribe\",\"SNS:ListSubscriptionsByTopic\",\"SNS:Publish\"],\"Condition\":{\"StringEquals\":{\"AWS:SourceOwner\":\"970547342690\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Resource\":\"arn:aws:sns:us-east-1:970547342690:secure-cicd-approval-requests\",\"Sid\":\"__default_statement_ID\"}],\"Version\":\"2008-10-17\"}",
            "signature_version": 0,
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": 0,
            "tags": {
              "Name": "secure-cicd-approval-requests"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-approval-requests",
              "Project": "SecureCICD"
            },
            "tracing_config": ""
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.secrets"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "pipeline_notifications",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": 0,
            "archive_policy": "",
            "arn": "arn:aws:sns:us-east-1:970547342690:secure-cicd-pipeline-notifications",
            "beginning_archive_time": "",
            "content_based_deduplication": false,
            "delivery_policy": "",
            "display_name": "",
            "fifo_throughput_scope": "",
            "fifo_topic": false,
            "firehose_failure_feedback_role_arn": "",
            "firehose_success_feedback_role_arn": "",
            "firehose_success_feedback_sample_rate": 0,
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": 0,
            "id": "arn:aws:sns:us-east-1:970547342690:secure-cicd-pipeline-notifications",
            "kms_master_key_id": "3579e2eb-ff74-42d3-8122-18fc70a85b16",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": 0,
            "name": "secure-cicd-pipeline-notifications",
            "name_prefix": "",
            "owner": "970547342690",
            "policy": "{\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Action\":[\"SNS:GetTopicAttributes\",\"SNS:SetTopicAttributes\",\"SNS:AddPermission\",\"SNS:RemovePermission\",\"SNS:DeleteTopic\",\"SNS:Subscribe\",\"SNS:ListSubscriptionsByTopic\",\"SNS:Publish\"],\"Condition\":{\"StringEquals\":{\"AWS:SourceOwner\":\"970547342690\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Resource\":\"arn:aws:sns:us-east-1:970547342690:secure-cicd-pipeline-notifications\",\"Sid\":\"__default_statement_ID\"}],\"Version\":\"2008-10-17\"}",
            "signature_version": 0,
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": 0,
            "tags": {
              "Name": "secure-cicd-pipeline-notifications"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-pipeline-notifications",
              "Project": "SecureCICD"
            },
            "tracing_config": ""
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.secrets"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "security_alerts",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": 0,
            "archive_policy": "",
            "arn": "arn:aws:sns:us-east-1:970547342690:secure-cicd-security-alerts",
            "beginning_archive_time": "",
            "content_based_deduplication": false,
            "delivery_policy": "",
            "display_name": "",
            "fifo_throughput_scope": "",
            "fifo_topic": false,
            "firehose_failure_feedback_role_arn": "",
            "firehose_success_feedback_role_arn": "",
            "firehose_success_feedback_sample_rate": 0,
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": 0,
            "id": "arn:aws:sns:us-east-1:970547342690:secure-cicd-security-alerts",
            "kms_master_key_id": "3579e2eb-ff74-42d3-8122-18fc70a85b16",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": 0,
            "name": "secure-cicd-security-alerts",
            "name_prefix": "",
            "owner": "970547342690",
            "policy": "{\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Action\":[\"SNS:GetTopicAttributes\",\"SNS:SetTopicAttributes\",\"SNS:AddPermission\",\"SNS:RemovePermission\",\"SNS:DeleteTopic\",\"SNS:Subscribe\",\"SNS:ListSubscriptionsByTopic\",\"SNS:Publish\"],\"Condition\":{\"StringEquals\":{\"AWS:SourceOwner\":\"970547342690\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Resource\":\"arn:aws:sns:us-east-1:970547342690:secure-cicd-security-alerts\",\"Sid\":\"__default_statement_ID\"}],\"Version\":\"2008-10-17\"}",
            "signature_version": 0,
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": 0,
            "tags": {
              "Name": "secure-cicd-security-alerts"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "secure-cicd-security-alerts",
              "Project": "SecureCICD"
            },
            "tracing_config": ""
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.secrets"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "approval_emails",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:970547342690:secure-cicd-approval-requests:ec1fc3a2-af1a-4e92-bf01-602412ad5a9b",
            "confirmation_timeout_in_minutes": 1,
            "confirmation_was_authenticated": false,
            "delivery_policy": "",
            "endpoint": "winnerselekwachi@gmail.com",
            "endpoint_auto_confirms": false,
            "filter_policy": "",
            "filter_policy_scope": "",
            "id": "arn:aws:sns:us-east-1:970547342690:secure-cicd-approval-requests:ec1fc3a2-af1a-4e92-bf01-602412ad5a9b",
            "owner_id": "970547342690",
            "pending_confirmation": true,
            "protocol": "email",
            "raw_message_delivery": false,
            "redrive_policy": "",
            "replay_policy": "",
            "subscription_role_arn": "",
            "topic_arn": "arn:aws:sns:us-east-1:970547342690:secure-cicd-approval-requests"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.secrets",
            "aws_sns_topic.approval_requests"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "pipeline_email",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:970547342690:secure-cicd-pipeline-notifications:585c3ab2-0ca1-4d55-9827-a1a85696e596",
            "confirmation_timeout_in_minutes": 1,
            "confirmation_was_authenticated": false,
            "delivery_policy": "",
            "endpoint": "winnerselekwachi@gmail.com",
            "endpoint_auto_confirms": false,
            "filter_policy": "",
            "filter_policy_scope": "",
            "id": "arn:aws:sns:us-east-1:970547342690:secure-cicd-pipeline-notifications:585c3ab2-0ca1-4d55-9827-a1a85696e596",
            "owner_id": "970547342690",
            "pending_confirmation": true,
            "protocol": "email",
            "raw_message_delivery": false,
            "redrive_policy": "",
            "replay_policy": "",
            "subscription_role_arn": "",
            "topic_arn": "arn:aws:sns:us-east-1:970547342690:secure-cicd-pipeline-notifications"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.secrets",
            "aws_sns_topic.pipeline_notifications"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "security_email",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:970547342690:secure-cicd-security-alerts:afab3e27-eee7-417c-a9f0-68692020339b",
            "confirmation_timeout_in_minutes": 1,
            "confirmation_was_authenticated": false,
            "delivery_policy": "",
            "endpoint": "winnerselekwachi@gmail.com",
            "endpoint_auto_confirms": false,
            "filter_policy": "",
            "filter_policy_scope": "",
            "id": "arn:aws:sns:us-east-1:970547342690:secure-cicd-security-alerts:afab3e27-eee7-417c-a9f0-68692020339b",
            "owner_id": "970547342690",
            "pending_confirmation": true,
            "protocol": "email",
            "raw_message_delivery": false,
            "redrive_policy": "",
            "replay_policy": "",
            "subscription_role_arn": "",
            "topic_arn": "arn:aws:sns:us-east-1:970547342690:secure-cicd-security-alerts"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.secrets",
            "aws_sns_topic.security_alerts"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_id",
      "name": "suffix",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "b64_std": "jjBPrg==",
            "b64_url": "jjBPrg",
            "byte_length": 4,
            "dec": "2385530798",
            "hex": "8e304fae",
            "id": "jjBPrg",
            "keepers": null,
            "prefix": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    }
  ],
  "check_results": [
    {
      "object_kind": "var",
      "config_addr": "var.policy_enforcement_mode",
      "status": "pass",
      "objects": [
        {
          "object_addr": "var.policy_enforcement_mode",
          "status": "pass"
        }
      ]
    }
  ]
}
